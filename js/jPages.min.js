 /**
 * jQuery jPages v0.7
 * Client side pagination with jQuery
 * http://luis-almeida.github.com/jPages
 *
 * Licensed under the MIT license.
 * Copyright 2012 Luís Almeida
 * https://github.com/luis-almeida
 */

(function(f,e,b,h){var c="jPages",a=null,g={container:"",first:false,previous:"← previous",next:"next →",last:false,links:"numeric",startPage:1,perPage:10,midRange:5,startRange:1,endRange:1,keyBrowse:false,scrollBrowse:false,pause:0,clickStop:false,delay:50,direction:"forward",animation:"",fallback:400,minHeight:true,callback:h};function d(j,i){this.options=f.extend({},g,i);this._container=f(this.options.container);if(!this._container.length){return}this.jQwindow=f(e);this.jQdocument=f(b);this._holder=f(j);this._nav={};this._first=f(this.options.first);this._previous=f(this.options.previous);this._next=f(this.options.next);this._last=f(this.options.last);this._items=this._container.children();this._itemsShowing=f([]);this._itemsHiding=f([]);this._numPages=Math.ceil(this._items.length/this.options.perPage);this._currentPageNum=this.options.startPage;this._clicked=false;this._cssAnimSupport=this.getCSSAnimationSupport();this.init()}d.prototype={constructor:d,getCSSAnimationSupport:function(){var m=false,o="animation",l="",k="Webkit Moz O ms Khtml".split(" "),n="",p=this._container.get(0);if(p.style.animationName){m=true}if(m===false){for(var j=0;j<k.length;j++){if(p.style[k[j]+"AnimationName"]!==h){n=k[j];o=n+"Animation";l="-"+n.toLowerCase()+"-";m=true;break}}}return m},init:function(){this.setStyles();this.setNav();this.paginate(this._currentPageNum);this.setMinHeight()},setStyles:function(){var i="<style>.jp-invisible { visibility: hidden !important; } .jp-hidden { display: none !important; }</style>";f(i).appendTo("head");if(this._cssAnimSupport&&this.options.animation.length){this._items.addClass("animated jp-hidden")}else{this._items.hide()}},setNav:function(){var i=this.writeNav();this._holder.each(this.bind(function(j,l){var k=f(l);k.html(i);this.cacheNavElements(k,j);this.bindNavHandlers(j);this.disableNavSelection(l)},this));if(this.options.keyBrowse){this.bindNavKeyBrowse()}if(this.options.scrollBrowse){this.bindNavScrollBrowse()}},writeNav:function(){var k=1,j;j=this.writeBtn("first")+this.writeBtn("previous");for(;k<=this._numPages;k++){if(k===1&&this.options.startRange===0){j+="<span>...</span>"}if(k>this.options.startRange&&k<=this._numPages-this.options.endRange){j+="<a href='#' class='jp-hidden'>"}else{j+="<a>"}switch(this.options.links){case"numeric":j+=k;break;case"blank":break;case"title":var l=this._items.eq(k-1).attr("data-title");j+=l!==h?l:"";break}j+="</a>";if(k===this.options.startRange||k===this._numPages-this.options.endRange){j+="<span>...</span>"}}j+=this.writeBtn("next")+this.writeBtn("last")+"</div>";return j},writeBtn:function(i){return this.options[i]!==false&&!f(this["_"+i]).length?"<a class='jp-"+i+"'>"+this.options[i]+"</a>":""},cacheNavElements:function(j,i){this._nav[i]={};this._nav[i].holder=j;this._nav[i].first=this._first.length?this._first:this._nav[i].holder.find("a.jp-first");this._nav[i].previous=this._previous.length?this._previous:this._nav[i].holder.find("a.jp-previous");this._nav[i].next=this._next.length?this._next:this._nav[i].holder.find("a.jp-next");this._nav[i].last=this._last.length?this._last:this._nav[i].holder.find("a.jp-last");this._nav[i].fstBreak=this._nav[i].holder.find("span:first");this._nav[i].lstBreak=this._nav[i].holder.find("span:last");this._nav[i].pages=this._nav[i].holder.find("a").not(".jp-first, .jp-previous, .jp-next, .jp-last");this._nav[i].permPages=this._nav[i].pages.slice(0,this.options.startRange).add(this._nav[i].pages.slice(this._numPages-this.options.endRange,this._numPages));this._nav[i].pagesShowing=f([]);this._nav[i].currentPage=f([])},bindNavHandlers:function(i){var j=this._nav[i];j.holder.bind("click.jPages",this.bind(function(k){var l=this.getNewPage(j,f(k.target));if(this.validNewPage(l)){this._clicked=true;this.paginate(l)}k.preventDefault()},this));if(this._first.length){this._first.bind("click.jPages",this.bind(function(){if(this.validNewPage(1)){this._clicked=true;this.paginate(1)}},this))}if(this._previous.length){this._previous.bind("click.jPages",this.bind(function(){var k=this._currentPageNum-1;if(this.validNewPage(k)){this._clicked=true;this.paginate(k)}},this))}if(this._next.length){this._next.bind("click.jPages",this.bind(function(){var k=this._currentPageNum+1;if(this.validNewPage(k)){this._clicked=true;this.paginate(k)}},this))}if(this._last.length){this._last.bind("click.jPages",this.bind(function(){if(this.validNewPage(this._numPages)){this._clicked=true;this.paginate(this._numPages)}},this))}},disableNavSelection:function(i){if(typeof i.onselectstart!="undefined"){i.onselectstart=function(){return false}}else{if(typeof i.style.MozUserSelect!="undefined"){i.style.MozUserSelect="none"}else{i.onmousedown=function(){return false}}}},bindNavKeyBrowse:function(){this.jQdocument.bind("keydown.jPages",this.bind(function(i){var k=i.target.nodeName.toLowerCase();if(this.elemScrolledIntoView()&&k!=="input"&&k!="textarea"){var j=this._currentPageNum;if(i.which==37){j=this._currentPageNum-1}if(i.which==39){j=this._currentPageNum+1}if(this.validNewPage(j)){this._clicked=true;this.paginate(j)}}},this))},elemScrolledIntoView:function(){var l,k,i,j;l=this.jQwindow.scrollTop();k=l+this.jQwindow.height();i=this._container.offset().top;j=i+this._container.height();return((j>=l)&&(i<=k))},bindNavScrollBrowse:function(){this._container.bind("mousewheel.jPages DOMMouseScroll.jPages",this.bind(function(i){var j=(i.originalEvent.wheelDelta||-i.originalEvent.detail)>0?(this._currentPageNum-1):(this._currentPageNum+1);if(this.validNewPage(j)){this._clicked=true;this.paginate(j)}i.preventDefault();return false},this))},getNewPage:function(j,i){if(i.is(j.currentPage)){return this._currentPageNum}if(i.is(j.pages)){return j.pages.index(i)+1}if(i.is(j.first)){return 1}if(i.is(j.last)){return this._numPages}if(i.is(j.previous)){return j.pages.index(j.currentPage)}if(i.is(j.next)){return j.pages.index(j.currentPage)+2}},validNewPage:function(i){return i!==this._currentPageNum&&i>0&&i<=this._numPages},paginate:function(j){var i,k;i=this.updateItems(j);k=this.updatePages(j);this._currentPageNum=j;if(f.isFunction(this.options.callback)){this.callback(j,i,k)}this.updatePause()},updateItems:function(j){var i=this.getItemRange(j);this._itemsHiding=this._itemsShowing;this._itemsShowing=this._items.slice(i.start,i.end);if(this._cssAnimSupport&&this.options.animation.length){this.cssAnimations(j)}else{this.jQAnimations(j)}return i},getItemRange:function(j){var i={};i.start=(j-1)*this.options.perPage;i.end=i.start+this.options.perPage;if(i.end>this._items.length){i.end=this._items.length}return i},cssAnimations:function(i){clearInterval(this._delay);this._itemsHiding.removeClass(this.options.animation+" jp-invisible").addClass("jp-hidden");this._itemsShowing.removeClass("jp-hidden").addClass("jp-invisible");this._itemsOriented=this.getDirectedItems(i);this._index=0;this._delay=setInterval(this.bind(function(){if(this._index===this._itemsOriented.length){clearInterval(this._delay)}else{this._itemsOriented.eq(this._index).removeClass("jp-invisible").addClass(this.options.animation)}this._index=this._index+1},this),this.options.delay)},jQAnimations:function(i){clearInterval(this._delay);this._itemsHiding.addClass("jp-hidden");this._itemsShowing.fadeTo(0,0).removeClass("jp-hidden");this._itemsOriented=this.getDirectedItems(i);this._index=0;this._delay=setInterval(this.bind(function(){if(this._index===this._itemsOriented.length){clearInterval(this._delay)}else{this._itemsOriented.eq(this._index).fadeTo(this.options.fallback,1)}this._index=this._index+1},this),this.options.delay)},getDirectedItems:function(i){var j;switch(this.options.direction){case"backwards":j=f(this._itemsShowing.get().reverse());break;case"random":j=f(this._itemsShowing.get().sort(function(){return(Math.round(Math.random())-0.5)}));break;case"auto":j=i>=this._currentPageNum?this._itemsShowing:f(this._itemsShowing.get().reverse());break;default:j=this._itemsShowing}return j},updatePages:function(k){var i,j,l;i=this.getInterval(k);for(j in this._nav){if(this._nav.hasOwnProperty(j)){l=this._nav[j];this.updateBtns(l,k);this.updateCurrentPage(l,k);this.updatePagesShowing(l,i);this.updateBreaks(l,i)}}return i},getInterval:function(l){var k,j,m,i;k=Math.ceil(this.options.midRange/2);j=this._numPages-this.options.midRange;m=l>k?Math.max(Math.min(l-k,j),0):0;i=l>k?Math.min(l+k-(this.options.midRange%2>0?1:0),this._numPages):Math.min(this.options.midRange,this._numPages);return{start:m,end:i}},updateBtns:function(j,i){if(i===1){j.first.addClass("jp-disabled");j.previous.addClass("jp-disabled")}if(i===this._numPages){j.next.addClass("jp-disabled");j.last.addClass("jp-disabled")}if(this._currentPageNum===1&&i>1){j.first.removeClass("jp-disabled");j.previous.removeClass("jp-disabled")}if(this._currentPageNum===this._numPages&&i<this._numPages){j.next.removeClass("jp-disabled");j.last.removeClass("jp-disabled")}},updateCurrentPage:function(j,i){j.currentPage.removeClass("jp-current");j.currentPage=j.pages.eq(i-1).addClass("jp-current")},updatePagesShowing:function(k,i){var j=k.pages.slice(i.start,i.end).not(k.permPages);k.pagesShowing.not(j).addClass("jp-hidden");j.not(k.pagesShowing).removeClass("jp-hidden");k.pagesShowing=j},updateBreaks:function(j,i){if(i.start>this.options.startRange||(this.options.startRange===0&&i.start>0)){j.fstBreak.removeClass("jp-hidden")}else{j.fstBreak.addClass("jp-hidden")}if(i.end<this._numPages-this.options.endRange){j.lstBreak.removeClass("jp-hidden")}else{j.lstBreak.addClass("jp-hidden")}},callback:function(l,k,m){var i={current:l,interval:m,count:this._numPages},j={showing:this._itemsShowing,oncoming:this._items.slice(k.start+this.options.perPage,k.end+this.options.perPage),range:k,count:this._items.length};i.interval.start=i.interval.start+1;j.range.start=j.range.start+1;this.options.callback(i,j)},updatePause:function(){if(this.options.pause&&this._numPages>1){clearTimeout(this._pause);if(this.options.clickStop&&this._clicked){return}else{this._pause=setTimeout(this.bind(function(){this.paginate(this._currentPageNum!==this._numPages?this._currentPageNum+1:1)},this),this.options.pause)}}},setMinHeight:function(){if(this.options.minHeight&&!this._container.is("table, tbody")){setTimeout(this.bind(function(){this._container.css({"min-height":this._container.css("height")})},this),1000)}},bind:function(i,j){return function(){return i.apply(j,arguments)}},destroy:function(){this.jQdocument.unbind("keydown.jPages");this._container.unbind("mousewheel.jPages DOMMouseScroll.jPages");if(this.options.minHeight){this._container.css("min-height","")}if(this._cssAnimSupport&&this.options.animation.length){this._items.removeClass("animated jp-hidden jp-invisible "+this.options.animation)}else{this._items.removeClass("jp-hidden").fadeTo(0,1)}this._holder.unbind("click.jPages").empty()}};f.fn[c]=function(i){var j=f.type(i);if(j==="object"){if(this.length&&!f.data(this,c)){a=new d(this,i);this.each(function(){f.data(this,c,a)})}return this}if(j==="string"&&i==="destroy"){a.destroy();this.each(function(){f.removeData(this,c)});return this}if(j==="number"&&i%1===0){if(a.validNewPage(i)){a.paginate(i)}return this}return this}})(jQuery,window,document);